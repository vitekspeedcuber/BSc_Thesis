% функция правых частей уравнений движения в задаче трёх тел

function dxdt = func3bp(t, x, mu)

r = x(1:3);
v = x(4:6);
r1 = sqrt((r(1) + mu)^2 + (r(2))^2 + (r(3))^2);
r2 = sqrt((r(1) - 1 + mu)^2 + (r(2))^2 + (r(3))^2);

Ux = r(1) - (1 - mu)*(r(1) + mu)/r1^3 - mu*(r(1) - 1 + mu)/r2^3;
Uy = r(2) - (1 - mu)*r(2)/r1^3 - mu*r(2)/r2^3;
Uz = -(1 - mu)*r(3)/r1^3 - mu*r(3)/r2^3;

dxdt = [v; (2*v(2) + Ux); (-2*v(1) + Uy); Uz];

end
